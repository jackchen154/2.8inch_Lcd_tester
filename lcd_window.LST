C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LCD_WINDOW
OBJECT MODULE PLACED IN lcd_window.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE lcd_window.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "STC12C5A.h"
   2          #include "uart.h"
   3          #include "lcd_window.h"
   4          #include "main.h"
   5          #define uchar unsigned char
   6          #define FALSE  -1
   7          #define TRUE   0
   8          
   9          
  10          int Lcd_control(char *cmd)//æ¨¡å¼è®¾ç½®
  11          {
  12   1        //uchar receive_buf[4];//LCDè¿”å›æ•°æ®buf
  13   1        uchar *cmdbuf=(uchar *)cmd;
  14   1        uchar end_frame[]={0xff,0xff,0xff};//LCDå‘é€å¸§å°¾éƒ¨
  15   1        uchar len=0;
  16   1      
  17   1        while(*cmdbuf!='\0')//è®¡ç®—å­—ç¬¦ä¸ªæ•°
  18   1        {
  19   2          cmdbuf++;
  20   2          len++;
  21   2        }
  22   1         
  23   1        UART2_Send((uchar *)cmd,len);//å‘é€LCDæ§åˆ¶æŒ‡ä»¤
  24   1        delayms(10);
  25   1        UART2_Send(end_frame,3);//å‘é€LCDå¸§å°¾
  26   1      
  27   1        return TRUE;   
  28   1      
  29   1      }
  30          
  31          /******************************************************************
  32          åŠŸèƒ½ï¼šå°†ä¸€ä¸ª32ä½é•¿æ•´å‹å˜é‡datè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚æŠŠ1234è½¬ä¸º"1234"
  33          å‚æ•°ï¼šdat:å¾…è½¬çš„longå‹çš„å˜é‡
  34               str:æŒ‡å‘å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œè½¬æ¢åçš„å­—èŠ‚ä¸²æ”¾åœ¨å…¶ä¸­   
  35          è¿”å›ï¼šè½¬æ¢åçš„å­—ç¬¦ä¸²é•¿åº¦                                
  36          ******************************************************************/
  37          unsigned char int2str(int dat,unsigned char *str) // é•¿æ•´å‹æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè¿”å›å€¼ä¸ºè½¬æ¢å
             -çš„å­—ç¬¦ä¸²é•¿åº¦
  38          {
  39   1        signed char i=0;
  40   1        unsigned char len = 0;
  41   1        unsigned char buf[6]={0}; // é•¿æ•´æ•°æœ€å¤§å€¼4294967295ï¼Œè½¬ASCIIç åå ç”¨10+1=11å­—èŠ‚
  42   1        if (dat < 0)// å¦‚æœä¸ºè´Ÿæ•°ï¼Œé¦–å…ˆå–ç»å¯¹å€¼ï¼Œå¹¶æ·»åŠ è´Ÿå·
  43   1        {
  44   2          dat = -dat;
  45   2          *str++ = '-';
  46   2          len++;
  47   2        }
  48   1        do
  49   1        {// ä½ä½åœ¨å‰é«˜ä½åœ¨åé¡ºåºæ’åˆ—
  50   2          buf[i++] = dat % 10+0x30;// Cè¯­è¨€ä¸­æ•°ç»„ä¸‹æ ‡å›ºå®šä»0å¼€å§‹
  51   2          dat /= 10;
  52   2        } while (dat > 0);
  53   1        len += i;                 // iæœ€åçš„å€¼å°±æ˜¯æœ‰æ•ˆå­—ç¬¦çš„ä¸ªæ•°
  54   1        while (i-- > 0)           // é«˜ä½åœ¨å‰ä½ä½åœ¨åé¡ºåºæ’åˆ—
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 2   

  55   1        {
  56   2          *str++ = buf[i] ;
  57   2        }     
  58   1        *str = 0;                 // æ·»åŠ å­—ç¬¦ä¸²ç»“æŸç¬¦æ–¹ä¾¿ä½¿ç”¨KEILè‡ªå¸¦çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°å¤„ç
             -†
  59   1        return len;               // è¿”å›å­—ç¬¦ä¸²é•¿åº¦
  60   1      }
  61          
  62          
  63          int Lcd_set_val(char *cmd, int val)//æ¨¡å¼è®¾ç½®
  64          {
  65   1        //uchar receive_buf[4];
  66   1        uchar val_buf[5]={0};//intè½¬charçš„ç¼“å­˜ 
  67   1        uchar val_len=0;//è½¬æ¢åçš„æ•°å­—æœ‰å¤šå°‘ä½æ•°
  68   1        uchar *cmd_buf = (uchar *)cmd;
  69   1        uchar end_frame[]={0xff,0xff,0xff};//å¸§å°¾
  70   1        uchar cmd_len=0;
  71   1        val_len = int2str(val,val_buf);//æ•´å‹è½¬å­—ç¬¦å‹
  72   1      
  73   1        while(*cmd_buf!='\0')
  74   1        {
  75   2          cmd_buf++;
  76   2          cmd_len++;
  77   2        }
  78   1      
  79   1        UART2_Send((uchar *)cmd,cmd_len);//å‘é€LCDæ§åˆ¶æŒ‡ä»¤
  80   1      
  81   1        UART2_Send(val_buf,val_len);//å‘é€æ•°å­— 
  82   1      
  83   1        UART2_Send(end_frame,3);//å¸§å°¾éƒ¨
  84   1       
  85   1          return TRUE;    
  86   1      
  87   1      }
  88          
  89          
  90          //tou_led.txt="V2.0.2"
  91          //è¯¥ä¸ºè‡ªå¸¦æ¸…bufçš„æ­¥éª¤
  92          int Lcd_set_txt(char *cmd,unsigned short *real_data)//æ¨¡å¼è®¾ç½®
  93          {
  94   1      
  95   1        uchar *cmd_buf = (uchar *)cmd;
  96   1        uchar clear_data=50;
  97   1        uchar end_frame[]={0xff,0xff,0xff};//å¸§å°¾
  98   1        uchar disbuf[9]={0};
  99   1        uchar cmd_len=0;
 100   1      
 101   1        disbuf[0]='"';
 102   1        disbuf[1]='V';
 103   1        if((*(real_data)>>8)>9)//å¦‚æœä¸»ç‰ˆæœ¬å·å¤§äº9
 104   1        {
 105   2          disbuf[2]=(*(real_data)>>8)/10+48;
 106   2          disbuf[3]=(*(real_data)>>8)%10+48;
 107   2        }
 108   1        else
 109   1        {
 110   2          disbuf[2]= 32;//ç©ºæ ¼
 111   2          disbuf[3]=(*(real_data)>>8)+48;
 112   2        }
 113   1        disbuf[4]='.';
 114   1        disbuf[5]=(*(real_data)&0x00ff)+48;
 115   1        disbuf[6]='.';
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 3   

 116   1        disbuf[7]=(*(real_data+1)>>8)+48;
 117   1        disbuf[8]='"';
 118   1      
 119   1        while(*cmd_buf!='\0')
 120   1        {
 121   2          cmd_buf++;
 122   2          cmd_len++;
 123   2        }
 124   1      
 125   1        UART2_Send((uchar *)cmd,cmd_len);//å‘é€LCDæ§åˆ¶æŒ‡ä»¤
 126   1        
 127   1        if(*(real_data)==0 && *(real_data+1)==0)
 128   1        UART2_Send((uchar *)"\"no device\"",11);
 129   1        else
 130   1        UART2_Send(disbuf,9);//å‘é€å€¼ 
 131   1        
 132   1        UART2_Send(end_frame,3);//å¸§å°¾éƒ¨
 133   1       
 134   1        while(clear_data--)
 135   1        {
 136   2          *real_data=0x0000;
 137   2          real_data++;
 138   2        }  
 139   1        return TRUE;    
 140   1        
 141   1      }
 142          
 143          int ultrasonic_window(unsigned short *real_data)// ä¼ æ„Ÿå™¨çª—å£æ•°æ®åˆ·æ–°
 144          {        
 145   1         uchar clear_data=50; 
 146   1      
 147   1         send_data(0x81,0x80,27); 
 148   1         delayms(30);
 149   1         Lcd_set_val("d0.val=",(*(real_data+chaosheng1) >> 8)*10);
 150   1         Lcd_set_val("d2.val=",(*(real_data+chaosheng1) & 0x00ff)*10);
 151   1         Lcd_set_val("d4.val=",(*(real_data+chaosheng2) >>8)*10);
 152   1         Lcd_set_val("d6.val=",(*(real_data+chaosheng2) & 0x00ff)*10);
 153   1         Lcd_set_val("d8.val=",(*(real_data+chaosheng3) >> 8)*10);
 154   1         Lcd_set_val("da.val=",(*(real_data+chaosheng3) & 0x00ff)*10);
 155   1         Lcd_set_val("dc.val=",(*(real_data+chaosheng4) >> 8)*10);
 156   1         Lcd_set_val("de.val=",(*(real_data+chaosheng4) & 0x00ff)*10);
 157   1         Lcd_set_val("e0.val=",(*(real_data+chaosheng5) >> 8)*10);
 158   1         Lcd_set_val("e2.val=",(*(real_data+chaosheng5) & 0x00ff)*10);
 159   1         Lcd_set_val("e4.val=",(*(real_data+chaosheng6) >> 8)*10);
 160   1         Lcd_set_val("e8.val=",(*(real_data+chaosheng6) & 0x00ff)*10);
 161   1         Lcd_set_val("hongwaizuo.val=",(*(real_data+hongwai2) >> 8)*2);
 162   1         Lcd_set_val("hongwaiyou.val=",(*(real_data+hongwai2) & 0x00ff)*2);
 163   1         
 164   1         //è¯»å–ç‰ˆæœ¬å·
 165   1         send_data(0x81,0xCA,2); 
 166   1         delayms(30);    
 167   1         Lcd_set_txt("val1.txt=",real_data);//0å·æ¿
 168   1         send_data(0x81,0xCC,2); 
 169   1         delayms(30);  
 170   1         Lcd_set_txt("val2.txt=",real_data);//1å·æ¿
 171   1         send_data(0x81,0xCE,2); 
 172   1         delayms(30);  
 173   1         Lcd_set_txt("val3.txt=",real_data);//2å·æ¿
 174   1         send_data(0x81,0xD0,2); 
 175   1         delayms(30);  
 176   1         Lcd_set_txt("val4.txt=",real_data);//3å·æ¿
 177   1         
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 4   

 178   1         while(clear_data--)
 179   1         {
 180   2          *real_data=0x0000;
 181   2          real_data++;
 182   2         }
 183   1        
 184   1         if(lcd_status==Return_button)
 185   1         {
 186   2              Lcd_control("page main");
 187   2              lcd_status = main_window;
 188   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 189   2         }
 190   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 191   1      }
 192          int ultrasonic_window1(unsigned short *real_data)// ä¼ æ„Ÿå™¨çª—å£æ•°æ®åˆ·æ–°
 193          {        
 194   1         uchar clear_data=50; 
 195   1      
 196   1         send_data(0x81,0x8b,16); 
 197   1         delayms(30);
 198   1         Lcd_set_val("d0.val=",(*(real_data) >> 8)*10);
 199   1         Lcd_set_val("d1.val=",(*(real_data) & 0x00ff)*10);
 200   1         Lcd_set_val("d2.val=",(*(real_data+1) >>8)*10);
 201   1         Lcd_set_val("d3.val=",(*(real_data+1) & 0x00ff)*10);
 202   1         Lcd_set_val("d4.val=",(*(real_data+2) >> 8)*10);
 203   1         Lcd_set_val("d5.val=",(*(real_data+2) & 0x00ff)*10);
 204   1         Lcd_set_val("d6.val=",(*(real_data+3) >> 8)*10);
 205   1         Lcd_set_val("d7.val=",(*(real_data+3) & 0x00ff)*10);
 206   1         Lcd_set_val("d8.val=",(*(real_data+4) >> 8)*10);
 207   1         Lcd_set_val("d9.val=",(*(real_data+4) & 0x00ff)*10);
 208   1         Lcd_set_val("d10.val=",(*(real_data+5) >> 8)*10);
 209   1         //Lcd_set_val("e8.val=",(*(real_data+5) & 0x00ff)*10);
 210   1         Lcd_set_val("hongwaizuo.val=",(*(real_data+6) & 0x00ff)*2);
 211   1         Lcd_set_val("hongwaiyou.val=",(*(real_data+7) & 0x00ff)*2);
 212   1         
 213   1         /*/è¯»å–ç‰ˆæœ¬å·
 214   1         send_data(0x81,0xCA,2); 
 215   1         delayms(30);    
 216   1         Lcd_set_txt("val1.txt=",real_data);//0å·æ¿
 217   1         send_data(0x81,0xCC,2); 
 218   1         delayms(30);  
 219   1         Lcd_set_txt("val2.txt=",real_data);//1å·æ¿
 220   1         send_data(0x81,0xCE,2); 
 221   1         delayms(30);  
 222   1         Lcd_set_txt("val3.txt=",real_data);//2å·æ¿
 223   1         send_data(0x81,0xD0,2); 
 224   1         delayms(30);  
 225   1         Lcd_set_txt("val4.txt=",real_data);//3å·æ¿
 226   1         */
 227   1         while(clear_data--)
 228   1         {
 229   2          *real_data=0x0000;
 230   2          real_data++;
 231   2         }
 232   1        
 233   1         if(lcd_status==Return_button1)
 234   1         {
 235   2              Lcd_control("page main1");
 236   2              lcd_status = main_window;
 237   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 238   2         }
 239   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 5   

 240   1      }
 241          
 242          
 243          
 244          int version_window(unsigned short *real_data)// ä¼ æ„Ÿå™¨çª—å£æ•°æ®åˆ·æ–°
 245          {        
 246   1             TH1 = 0xf7;  
 247   1             TL1 = TH1; //38400æ³¢ç‰¹ç‡ 
 248   1             delayms(30);
 249   1             //ç”µæºç®¡ç†æ¿
 250   1            send_data(0x05,0x78,3);
 251   1            delayms(30);
 252   1            Lcd_set_txt("dianyuanguanli.txt=",real_data);
 253   1            //èˆµæœºæ¿
 254   1            send_data(0x01,0x78,3);
 255   1            delayms(30);
 256   1            Lcd_set_txt("tou_duoji.txt=",real_data);
 257   1            //å•æµ‹å³è½®
 258   1            send_data(0x02,0x78,3);
 259   1            delayms(30);
 260   1            Lcd_set_txt("danyoulun.txt=",real_data);
 261   1            //å·¦æ‰‹
 262   1            send_data(0x06,0x78,3);
 263   1            delayms(30);
 264   1            Lcd_set_txt("zuoshou.txt=",real_data);
 265   1            //å³æ‰‹
 266   1            send_data(0x07,0x78,3);
 267   1            delayms(30);
 268   1            Lcd_set_txt("youshou.txt=",real_data);
 269   1            //å¤´å‘¼å¸ç¯æ¿
 270   1            send_data(0x03,0x78,3);
 271   1            delayms(30);
 272   1            Lcd_set_txt("tou_led.txt=",real_data);
 273   1            
 274   1            TH1 = 0xFD;   
 275   1            TL1 = TH1;  //115200æ³¢ç‰¹ç‡ 
 276   1            //ä¸»æ§æ¿
 277   1            send_data(0x81,0x78,3);
 278   1            delayms(30);
 279   1            Lcd_set_txt("zhukong.txt=",real_data);
 280   1            //è¶…å®½å¸¦
 281   1            send_data(0x81,0xB1,3);
 282   1            delayms(30);
 283   1            Lcd_set_txt("chaokuandai.txt=",real_data);      
 284   1            //å·¦è½®
 285   1            send_data(0x81,0xB4,3);
 286   1            delayms(30);
 287   1            Lcd_set_txt("zuolun.txt=",real_data);    
 288   1            //å³è½®
 289   1            send_data(0x81,0xB7,3);
 290   1            delayms(30);
 291   1            Lcd_set_txt("youlun.txt=",real_data);
 292   1            
 293   1           if(lcd_status==Return_button)
 294   1           {
 295   2              Lcd_control("page main");
 296   2              lcd_status = main_window;
 297   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 298   2           }
 299   1         
 300   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 301   1      }
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 6   

 302          int version_window1(unsigned short *real_data)// ä¼ æ„Ÿå™¨çª—å£æ•°æ®åˆ·æ–°
 303          {        
 304   1             TH1 = 0xf7;  
 305   1             TL1 = TH1; //38400æ³¢ç‰¹ç‡ 
 306   1             delayms(30);
 307   1      
 308   1            //å•æµ‹å·¦è½®
 309   1            send_data(0x01,0x78,3);
 310   1            delayms(30);
 311   1            Lcd_set_txt("danzuolun.txt=",real_data);
 312   1            //å•æµ‹å³è½®
 313   1            send_data(0x02,0x78,3);
 314   1            delayms(30);
 315   1            Lcd_set_txt("danyoulun.txt=",real_data);
 316   1      
 317   1            
 318   1            TH1 = 0xFD;   
 319   1            TL1 = TH1;  //115200æ³¢ç‰¹ç‡ 
 320   1            //ä¸»æ§æ¿
 321   1            send_data(0x81,0x78,3);
 322   1            delayms(30);
 323   1            Lcd_set_txt("zhukong.txt=",real_data);
 324   1            //è¶…å®½å¸¦
 325   1            send_data(0x81,0xc0,3);
 326   1            delayms(30);
 327   1            Lcd_set_txt("chaokuandai.txt=",real_data);      
 328   1            //å·¦è½®
 329   1            send_data(0x81,0xc6,3);
 330   1            delayms(30);
 331   1            Lcd_set_txt("zuolun.txt=",real_data);    
 332   1            //å³è½®
 333   1            send_data(0x81,0xc9,3);
 334   1            delayms(30);
 335   1            Lcd_set_txt("youlun.txt=",real_data);
 336   1            //ç”µæºç®¡ç†
 337   1            send_data(0x81,0xc3,3);
 338   1            delayms(30);
 339   1            Lcd_set_txt("dianyuanguanli.txt=",real_data);   
 340   1            //è¶…å£°æ³¢1
 341   1            send_data(0x81,0xcc,3);
 342   1            delayms(30);
 343   1            Lcd_set_txt("chaosheng1.txt=",real_data);
 344   1            //è¶…å£°æ³¢2
 345   1            send_data(0x81,0xcf,3);
 346   1            delayms(30);
 347   1            Lcd_set_txt("chaosheng2.txt=",real_data);
 348   1            
 349   1            //èˆµæœºæ¿
 350   1            send_data(0x82,0x70,3);
 351   1            delayms(100);
 352   1            Lcd_set_txt("tou_duoji.txt=",real_data);
 353   1            delayms(100);
 354   1           if(lcd_status==Return_button1)
 355   1           {
 356   2              Lcd_control("page main1");
 357   2              lcd_status = main_window;
 358   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 359   2           }
 360   1         
 361   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 362   1      }
 363          
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 7   

 364          int motor_ctrl_window(unsigned short *real_data)//èˆµæœºæ§åˆ¶çª—å£
 365          {        
 366   1               
 367   1            uchar turn_speed = 10;
 368   1            send_data(0x01,0x7e,2);
 369   1            delayms(30);
 370   1            Lcd_set_val("hbianmaqiz.val=", (int)(*(real_data)));
 371   1            delayms(30);
 372   1            Lcd_set_val("hbiaodingz.val=", (int)(*(real_data+1)));
 373   1            *(real_data)=0;
 374   1            *(real_data+1)=0;
 375   1      
 376   1            send_data(0x06,0x7e,2);
 377   1            delayms(30);
 378   1            Lcd_set_val("zbianmaqiz.val=", (int)(*(real_data)));
 379   1            delayms(30);
 380   1            Lcd_set_val("zbiaodingz.val=", (int)(*(real_data+1)));
 381   1            *(real_data)=0;
 382   1            *(real_data+1)=0;
 383   1      
 384   1            send_data(0x07,0x7e,2);
 385   1            delayms(30);
 386   1            Lcd_set_val("ybianmaqiz.val=", (int)(*(real_data)));
 387   1            delayms(30);
 388   1            Lcd_set_val("ybiaodingz.val=", (int)(*(real_data+1)));
 389   1            *(real_data)=0;
 390   1            *(real_data+1)=0;
 391   1            //*å¤´éƒ¨æ§åˆ¶éƒ¨åˆ†
 392   1            if(lcd_status==hbiaoding)//å¤´éƒ¨æ ‡å®šæ£€æµ‹
 393   1            {
 394   2              motor_contrl_send(0x01,0x05,0,0);
 395   2              delayms(30);
 396   2              motor_contrl_send(0x01,0x05,0,0);
 397   2              delayms(30);         
 398   2              motor_contrl_send(0x01,0x00,0,0);
 399   2            }
 400   1            if(lcd_status==hzuo)//å¤´éƒ¨æ­£è½¬
 401   1            {
 402   2              motor_contrl_send(0x01,0x01,turn_speed,0);    
 403   2            }
 404   1            if(lcd_status==hyou)//å¤´éƒ¨åè½¬
 405   1            {
 406   2              motor_contrl_send(0x01,0x02,turn_speed,0);        
 407   2            }
 408   1            if(lcd_status==hzhong)//å¤´éƒ¨æ­£ä¸­
 409   1            {
 410   2              motor_contrl_send( 0x01,0x03,turn_speed,180);
 411   2              delayms(2000);
 412   2              motor_contrl_send( 0x01,0x00,0,0);        
 413   2            }//*/
 414   1      
 415   1            //å·¦æ‰‹æ§åˆ¶éƒ¨åˆ†
 416   1            if(lcd_status==zbiaoding)//å·¦æ‰‹æ ‡å®šæ£€æµ‹
 417   1            {
 418   2              motor_contrl_send( 0x06,0x05,0,0);
 419   2              delayms(30);
 420   2              motor_contrl_send( 0x06,0x05,0,0);
 421   2              delayms(30);         
 422   2              motor_contrl_send( 0x06,0x00,0,0);//é€€å‡ºæ ‡å®šçŠ¶æ€
 423   2            }
 424   1            if(lcd_status==zzuo)//å·¦æ‰‹æ­£è½¬
 425   1            {
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 8   

 426   2              motor_contrl_send( 0x06,0x01,7,0);    
 427   2            }
 428   1            if(lcd_status==zyou)//å·¦æ‰‹åè½¬
 429   1            {
 430   2              motor_contrl_send( 0x06,0x02,7,0);        
 431   2            }
 432   1            if(lcd_status==zzhong)//å·¦æ‰‹æ­£ä¸­
 433   1            {
 434   2              motor_contrl_send( 0x06,0x03,7,180);
 435   2              delayms(2000);
 436   2              motor_contrl_send( 0x06,0x00,0,0);        
 437   2            }
 438   1      
 439   1            //*å³æ‰‹æ§åˆ¶éƒ¨åˆ†
 440   1            if(lcd_status==ybiaoding)//å·¦æ‰‹æ ‡å®šæ£€æµ‹
 441   1            {
 442   2              motor_contrl_send( 0x07,0x05,0,0);
 443   2              delayms(30);
 444   2              motor_contrl_send( 0x07,0x05,0,0);
 445   2              delayms(30);         
 446   2              motor_contrl_send( 0x07,0x00,0,0);//é€€å‡ºæ ‡å®šçŠ¶æ€
 447   2            }
 448   1            if(lcd_status==yzuo)//å·¦æ‰‹æ­£è½¬
 449   1            {
 450   2              ////printf("yzuo\n");
 451   2              motor_contrl_send( 0x07,0x01,7,0);    
 452   2            }
 453   1            if(lcd_status==yyou)//å·¦æ‰‹åè½¬
 454   1            {
 455   2              ////printf("yyou\n");
 456   2              motor_contrl_send( 0x07,0x02,7,0);        
 457   2            }
 458   1            if(lcd_status==yzhong)//å·¦æ‰‹æ­£ä¸­
 459   1            {
 460   2              ////printf("yzhong\n");
 461   2              motor_contrl_send( 0x07,0x03,7,180);
 462   2              delayms(2000);
 463   2              motor_contrl_send( 0x07,0x00,0,0);        
 464   2            }
 465   1      
 466   1            //LEDç¯æ¿æ§åˆ¶éƒ¨åˆ†
 467   1            if(lcd_status==led00)
 468   1            {
 469   2              //printf("led00\n");
 470   2              led_contrl_send( 0x03,0,0,100);
 471   2            }
 472   1            if(lcd_status==led01)
 473   1            {
 474   2              //printf("led01\n");
 475   2              led_contrl_send( 0x03,0,35,100);
 476   2            }
 477   1            if(lcd_status==led10)
 478   1            {
 479   2              //printf("led10\n");
 480   2              led_contrl_send( 0x03,35,0,100);
 481   2            }
 482   1            if(lcd_status==led11)
 483   1            {
 484   2              //printf("led11\n");
 485   2              led_contrl_send( 0x03,35,35,100);
 486   2            }
 487   1      
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 9   

 488   1            //è¿ç»­æ§åˆ¶éƒ¨åˆ†
 489   1            if(lcd_status==alianxu1)
 490   1            {
 491   2              //printf("alianxu1\n");
 492   2              while(1)
 493   2              {
 494   3                motor_contrl_send( 0x01,0x01,9,0);//å¤´éƒ¨æ­£è½¬
 495   3                delayms(30);
 496   3                motor_contrl_send( 0x06,0x01,7,0);//å·¦æ‰‹æ­£è½¬ 
 497   3                delayms(30);
 498   3                motor_contrl_send( 0x07,0x01,7,0);//å³æ‰‹æ­£è½¬ 
 499   3                delayms(30);
 500   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹
 501   3                if(lcd_status==Return_button) break;
 502   3                delayms(3500);
 503   3                if(lcd_status==Return_button) break;
 504   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹     
 505   3                motor_contrl_send( 0x01,0x02,9,0);//å¤´éƒ¨åè½¬       
 506   3                delayms(30);
 507   3                motor_contrl_send( 0x06,0x02,7,0);//å·¦æ‰‹åè½¬
 508   3                delayms(30);
 509   3                if(lcd_status==Return_button) break;
 510   3                motor_contrl_send( 0x07,0x02,7,0);//å³æ‰‹åè½¬
 511   3                delayms(30);
 512   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹     
 513   3                delayms(3500);
 514   3                if(lcd_status==Return_button) break;
 515   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹       
 516   3              }
 517   2              //printf("alianxu0\n");
 518   2              //é€€å‡ºå›æ­£
 519   2              motor_contrl_send( 0x01,0x03,9,180);//å¤´å›æ­£
 520   2              delayms(30);
 521   2              motor_contrl_send( 0x06,0x03,7,180);//å·¦æ‰‹å›æ­£
 522   2              delayms(30);
 523   2              motor_contrl_send( 0x07,0x03,7,180);//å³æ‰‹å›æ­£
 524   2              delayms(30);
 525   2              delayms(2000);//ç­‰å¾…å›æ­£å®Œæ¯•
 526   2      
 527   2              //é€€å‡ºåè®¾ç½®ä¸ºè‡ªç„¶åœæ­¢
 528   2              motor_contrl_send( 0x01,0x00,0,0);//å¤´åœæ­¢ 
 529   2              delayms(30);
 530   2              motor_contrl_send( 0x06,0x00,0,0);//å·¦æ‰‹åœæ­¢ 
 531   2              delayms(30);
 532   2              motor_contrl_send( 0x07,0x00,0,0);//å³æ‰‹åœæ­¢
 533   2              delayms(30);      
 534   2            }//*/
 535   1      
 536   1           if(lcd_status==Return_button)//æŒ‰ä¸‹é€€å‡ºæŒ‰é”®
 537   1           {
 538   2              //printf("return_button\n");
 539   2              Lcd_control( "page main");
 540   2              lcd_status = main_window;
 541   2              //é€€å‡ºå›æ­£
 542   2              motor_contrl_send( 0x01,0x03,9,180);//å¤´å›æ­£
 543   2              delayms(30);
 544   2              motor_contrl_send( 0x06,0x03,7,180);//å·¦æ‰‹å›æ­£
 545   2              delayms(30);
 546   2              motor_contrl_send( 0x07,0x03,7,180);//å³æ‰‹å›æ­£
 547   2              delayms(30);
 548   2              delayms(2000);//ç­‰å¾…å›æ­£å®Œæ¯•
 549   2              //é€€å‡ºåè®¾ç½®ä¸ºè‡ªç„¶åœæ­¢
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 10  

 550   2              motor_contrl_send( 0x01,0x00,0,0);//å¤´åœæ­¢ 
 551   2              delayms(30);
 552   2              motor_contrl_send( 0x06,0x00,0,0);//å·¦æ‰‹åœæ­¢ 
 553   2              delayms(30);
 554   2              motor_contrl_send( 0x07,0x00,0,0);//å³æ‰‹åœæ­¢
 555   2              delayms(30); 
 556   2      
 557   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 558   2           }
 559   1      
 560   1           lcd_status=0;//çŠ¶æ€æ¸…é›¶
 561   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 562   1      }
 563          
 564          
 565          //*
 566          int motor_ctrl_window1()//èˆµæœºæ§åˆ¶çª—å£
 567          {        
 568   1               
 569   1            uchar turn_speed = 15;//15æœ€å¤§å€¼
 570   1            //å¤´éƒ¨æ§åˆ¶éƒ¨åˆ†  
 571   1      //void motor_contrl_send11(uchar reg_addr ,uchar ctrl_mode,uchar speed,uchar weizhi)//èˆµæœºæ§åˆ¶
 572   1            if(lcd_status==hbiaoding)//æ ‡å®šæ£€æµ‹
 573   1            {
 574   2              motor_contrl_send1(0x05,0x01,0,0);//å¤´æ ‡å®š
 575   2              delayms(30);
 576   2              motor_contrl_send1(0x16,0x05,0,0);//å·¦æ‰‹æ ‡å®š
 577   2              delayms(30);         
 578   2              motor_contrl_send1(0x22,0x05,0,0);//å³æ‰‹æ ‡å®š
 579   2            }
 580   1            if(lcd_status==hzuo)//å¤´éƒ¨æ­£è½¬
 581   1            {
 582   2              motor_contrl_send1(0x05,0x04,turn_speed,0);    
 583   2            }
 584   1            if(lcd_status==hyou)//å¤´éƒ¨åè½¬
 585   1            {
 586   2              motor_contrl_send1(0x05,0x04,turn_speed,180);        
 587   2            }
 588   1            if(lcd_status==hzhong)//å¤´éƒ¨æ­£ä¸­
 589   1            {
 590   2              motor_contrl_send1( 0x05,0x04,turn_speed,90);
 591   2              delayms(2000);
 592   2              motor_contrl_send1( 0x05,0x00,0,0);        
 593   2            }
 594   1      
 595   1            //å·¦æ‰‹æ§åˆ¶éƒ¨åˆ†
 596   1      
 597   1            if(lcd_status==zzuo)//å·¦æ‰‹æ­£è½¬
 598   1            {
 599   2              motor_contrl_send1( 0x16,0x03,turn_speed,360);    
 600   2            }
 601   1            if(lcd_status==zyou)//å·¦æ‰‹åè½¬
 602   1            {
 603   2              motor_contrl_send1( 0x16,0x03,turn_speed,120);        
 604   2            }
 605   1            if(lcd_status==zzhong)//å·¦æ‰‹æ­£ä¸­
 606   1            {
 607   2              motor_contrl_send1( 0x16,0x03,turn_speed,180);
 608   2              delayms(2000);
 609   2              motor_contrl_send1( 0x16,0x00,0,0);        
 610   2            }
 611   1      
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 11  

 612   1            //*å³æ‰‹æ§åˆ¶éƒ¨åˆ†
 613   1      
 614   1            if(lcd_status==yzuo)//æ­£è½¬
 615   1            {
 616   2              ////printf("yzuo\n");
 617   2              motor_contrl_send1( 0x22,0x03,turn_speed,360);    
 618   2            }
 619   1            if(lcd_status==yyou)//åè½¬
 620   1            {
 621   2              ////printf("yyou\n");
 622   2              motor_contrl_send1( 0x22,0x03,turn_speed,120);        
 623   2            }
 624   1            if(lcd_status==yzhong)//æ­£ä¸­
 625   1            {
 626   2              ////printf("yzhong\n");
 627   2              motor_contrl_send1( 0x22,0x03,turn_speed,180);
 628   2              delayms(2000);
 629   2              motor_contrl_send1( 0x22,0x00,0,0);        
 630   2            }
 631   1      //void led_contrl_send1(uchar power,uchar red,uchar green,uchar blue)//LEDæ§åˆ¶
 632   1            //LEDç¯æ¿æ§åˆ¶éƒ¨åˆ†
 633   1            if(lcd_status==led00)//å…³é—­
 634   1            {
 635   2              //printf("led00\n");
 636   2              led_contrl_send1( 0x00,0,0,0);
 637   2            }
 638   1            if(lcd_status==led01)//çº¢
 639   1            {
 640   2              //printf("led01\n");
 641   2              led_contrl_send1( 0x01,255,0,0);
 642   2            }
 643   1            if(lcd_status==led10)//ç»¿
 644   1            {
 645   2              //printf("led10\n");
 646   2              led_contrl_send1( 0x01,0,255,0);
 647   2            }
 648   1            if(lcd_status==led11)//è“
 649   1            {
 650   2              //printf("led11\n");
 651   2              led_contrl_send1( 0x01,0,0,255);
 652   2            }
 653   1      
 654   1            //è¿ç»­æ§åˆ¶éƒ¨åˆ†
 655   1            if(lcd_status==alianxu1)
 656   1            {
 657   2              //printf("alianxu1\n");
 658   2              while(1)
 659   2              {
 660   3                motor_contrl_send1( 0x05,0x04,turn_speed,0);//å¤´éƒ¨æ­£è½¬
 661   3                delayms(30);
 662   3                motor_contrl_send1( 0x16,0x03,turn_speed,360);//å·¦æ‰‹æ­£è½¬ 
 663   3                delayms(30);
 664   3                motor_contrl_send1( 0x22,0x03,turn_speed,360);//å³æ‰‹æ­£è½¬ 
 665   3                delayms(30);
 666   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹
 667   3                if(lcd_status==Return_button1) break;
 668   3                delayms(3500);
 669   3                if(lcd_status==Return_button1) break;
 670   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹     
 671   3                motor_contrl_send1( 0x05,0x04,turn_speed,180);//å¤´éƒ¨åè½¬       
 672   3                delayms(30);
 673   3                motor_contrl_send1( 0x16,0x03,turn_speed,120);//å·¦æ‰‹åè½¬
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 12  

 674   3                delayms(30);
 675   3                if(lcd_status==Return_button1) break;
 676   3                motor_contrl_send1( 0x22,0x03,turn_speed,120);//å³æ‰‹åè½¬
 677   3                delayms(30);
 678   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹     
 679   3                delayms(3500);
 680   3                if(lcd_status==Return_button1) break;
 681   3                if(lcd_status==alianxu0) break;//é€€å‡ºæ£€æµ‹       
 682   3              }
 683   2              //printf("alianxu0\n");
 684   2              //é€€å‡ºå›æ­£
 685   2              motor_contrl_send1( 0x05,0x04,turn_speed,90);//å¤´å›æ­£
 686   2              delayms(30);
 687   2              motor_contrl_send1( 0x16,0x03,turn_speed,180);//å·¦æ‰‹å›æ­£
 688   2              delayms(30);
 689   2              motor_contrl_send1( 0x22,0x03,turn_speed,180);//å³æ‰‹å›æ­£
 690   2              delayms(30);
 691   2              delayms(2000);//ç­‰å¾…å›æ­£å®Œæ¯•
 692   2      
 693   2              //é€€å‡ºåè®¾ç½®ä¸ºè‡ªç„¶åœæ­¢
 694   2              motor_contrl_send1( 0x05,0x00,0,0);//å¤´åœæ­¢ 
 695   2              delayms(30);
 696   2              motor_contrl_send1( 0x16,0x00,0,0);//å·¦æ‰‹åœæ­¢ 
 697   2              delayms(30);
 698   2              motor_contrl_send1( 0x22,0x00,0,0);//å³æ‰‹åœæ­¢
 699   2              delayms(30);      
 700   2            }//
 701   1      
 702   1           if(lcd_status==Return_button1)//æŒ‰ä¸‹é€€å‡ºæŒ‰é”®
 703   1           {
 704   2              //printf("return_button\n");
 705   2              Lcd_control( "page main1");
 706   2              lcd_status = main_window;
 707   2              //é€€å‡ºå›æ­£
 708   2              motor_contrl_send1( 0x05,0x04,turn_speed,90);//å¤´å›æ­£
 709   2              delayms(30);
 710   2              motor_contrl_send1( 0x16,0x03,turn_speed,180);//å·¦æ‰‹å›æ­£
 711   2              delayms(30);
 712   2              motor_contrl_send1( 0x22,0x03,turn_speed,180);//å³æ‰‹å›æ­£
 713   2              delayms(30);
 714   2              delayms(2000);//ç­‰å¾…å›æ­£å®Œæ¯•
 715   2      
 716   2              //é€€å‡ºåè®¾ç½®ä¸ºè‡ªç„¶åœæ­¢
 717   2              motor_contrl_send1( 0x05,0x00,0,0);//å¤´åœæ­¢ 
 718   2              delayms(30);
 719   2              motor_contrl_send1( 0x16,0x00,0,0);//å·¦æ‰‹åœæ­¢ 
 720   2              delayms(30);
 721   2              motor_contrl_send1( 0x22,0x00,0,0);//å³æ‰‹åœæ­¢
 722   2              delayms(30); 
 723   2      
 724   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 725   2           }
 726   1      
 727   1           lcd_status=0;//çŠ¶æ€æ¸…é›¶
 728   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 729   1      }//*/
 730          
 731          
 732          int Duojixianzhi_window(unsigned short *real_data)//èˆµæœºé™åˆ¶çª—å£
 733          {                
 734   1            //å¤´éƒ¨é™åˆ¶æŸ¥è¯¢
 735   1            send_data(0x01,0x80,1);//è¯»é™å®šç”µæµå€¼
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 13  

 736   1            delayms(30);
 737   1            Lcd_set_val("htouxianliu.val=", *(real_data));
 738   1            delayms(30);
 739   1            *(real_data)=0;
 740   1        
 741   1            send_data(0x01,0x0B,2);//è¯»é™ä½å€¼
 742   1            delayms(30);
 743   1            Lcd_set_val("htoushangxw.val=", (int)(*(real_data)));
 744   1            delayms(30);
 745   1            Lcd_set_val("htouxiaxw.val=", (int)(*(real_data+1)));
 746   1            *(real_data)=0;
 747   1            *(real_data+1)=0;
 748   1      
 749   1            //ä¿¯ä»°é™åˆ¶æŸ¥è¯¢
 750   1            send_data(0x02,0x80,1);//è¯»é™å®šç”µæµå€¼
 751   1            delayms(30);
 752   1            Lcd_set_val("fyxianliu.val=", *(real_data));
 753   1            delayms(30);
 754   1            *(real_data)=0;
 755   1        
 756   1            send_data(0x02,0x0B,2);//è¯»é™ä½å€¼
 757   1            delayms(30);
 758   1            Lcd_set_val("fyshangxianw.val=", (int)(*(real_data)));
 759   1            delayms(30);
 760   1            Lcd_set_val("fyxiaxianw.val=", (int)(*(real_data+1)));
 761   1            *(real_data)=0;
 762   1            *(real_data+1)=0;
 763   1      
 764   1            //å·¦æ‰‹é™åˆ¶æŸ¥è¯¢
 765   1            send_data(0x06,0x80,1);//è¯»é™å®šç”µæµå€¼
 766   1            delayms(30);
 767   1            Lcd_set_val("zuoxianliu.val=", *(real_data));
 768   1            delayms(30);
 769   1            *(real_data)=0;
 770   1        
 771   1            send_data(0x06,0x0B,2);//è¯»é™ä½å€¼
 772   1            delayms(30);
 773   1            Lcd_set_val("zuoshangxw.val=", (int)(*(real_data)));
 774   1            delayms(30);
 775   1            Lcd_set_val("zuoxiaxw.val=", (int)(*(real_data+1)));
 776   1            *(real_data)=0;
 777   1            *(real_data+1)=0;
 778   1            
 779   1            //å³æ‰‹é™åˆ¶æŸ¥è¯¢
 780   1            send_data(0x07,0x80,1);//è¯»é™å®šç”µæµå€¼
 781   1            delayms(30);
 782   1            Lcd_set_val("yshouxianliu.val=", *(real_data));
 783   1            delayms(30);
 784   1            *(real_data)=0;
 785   1        
 786   1            send_data(0x07,0x0B,2);//è¯»é™ä½å€¼
 787   1            delayms(30);
 788   1            Lcd_set_val("yshoushangxw.val=", (int)(*(real_data)));
 789   1            delayms(30);
 790   1            Lcd_set_val("yshaouxiaxw.val=", (int)(*(real_data+1)));
 791   1            *(real_data)=0;
 792   1            *(real_data+1)=0;     
 793   1            
 794   1            //*ä¸€é”®é™åˆ¶é…ç½®éƒ¨åˆ†
 795   1            if(lcd_status==set_limit_value)
 796   1            {
 797   2              //å¤´éƒ¨èˆµæœº 
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 14  

 798   2              limit_current_contrl_send(0x01,10);//å¤´0.6Açš„é™åˆ¶ç”µæµ
 799   2              delayms(30);
 800   2              limit_value_contrl_send(0x01 ,90,90);//å¤´90åº¦é™ä½å€¼å‘é€
 801   2              delayms(30);
 802   2              //ä¿¯ä»°èˆµæœº        
 803   2              limit_current_contrl_send(0x02,10);//ä¿¯ä»°0.6Açš„é™åˆ¶ç”µæµ
 804   2              delayms(30);
 805   2              limit_value_contrl_send(0x02 ,9,9);//å¹³å®‰ä¿¯ä»°9åº¦é™ä½å€¼å‘é€
 806   2              delayms(30);
 807   2              //å·¦æ‰‹èˆµæœº 
 808   2              limit_current_contrl_send(0x06,10);//å¤´1Açš„é™åˆ¶ç”µæµ
 809   2              delayms(30);
 810   2              limit_value_contrl_send(0x06 ,90,90);//å¤´90åº¦é™ä½å€¼å‘é€
 811   2              delayms(30);
 812   2              //å³æ‰‹èˆµæœº        
 813   2              limit_current_contrl_send(0x07,10);//ä¿¯ä»°1Açš„é™åˆ¶ç”µæµ
 814   2              delayms(30);
 815   2              limit_value_contrl_send(0x07 ,90,90);//ä¿¯ä»°90åº¦é™ä½å€¼å‘é€
 816   2              delayms(30);          
 817   2            }
 818   1      
 819   1           if(lcd_status==Return_button)//æŒ‰ä¸‹é€€å‡ºæŒ‰é”®
 820   1           {
 821   2              //printf("return_button\n");
 822   2              Lcd_control( "page main");
 823   2              lcd_status = main_window;
 824   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 825   2           }
 826   1      
 827   1           lcd_status=0;//çŠ¶æ€æ¸…é›¶
 828   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 829   1      }
 830          
 831          
 832          
 833          //void main_board_contrl_send(uchar run_mode,uchar left_speed,uchar right_speed);//ä¸»æ§æ¿å¤šå†™
 834          int robot_ctrl_window(unsigned short *real_data)//æ•´æœºæ§åˆ¶éƒ¨åˆ†
 835          {        
 836   1            *real_data = 0xf1f0;  
 837   1             switch(lcd_status)
 838   1             {
 839   2                case auto_charge_on : main_board_contrl_send(0x80,0,0);  break;
 840   2                case auto_charge_off : main_board_contrl_send(0x00,0,0);  break;
 841   2                case go_up : main_board_contrl_send(0x01,40,40);  break;
 842   2                case go_down : main_board_contrl_send(0x02,40,40); break;
 843   2                case go_left : main_board_contrl_send(0x04,0,25); break;
 844   2                case go_right : main_board_contrl_send(0x03,25,0); break;
 845   2                case go_stop : main_board_contrl_send(0x05,0,0); //è¢«åŠ¨åˆ¹è½¦
 846   2                               delayms(30);
 847   2                               main_board_contrl_send(0x00,0,0); //ç©ºæŒ¡æ— é˜»åŠ›
 848   2                               break;
 849   2                 default :break;
 850   2              }
 851   1          
 852   1           if(lcd_status==Return_button)//æŒ‰ä¸‹é€€å‡ºæŒ‰é”®
 853   1           {
 854   2              //printf("return_button\n");
 855   2              Lcd_control( "page main");
 856   2              lcd_status = main_window;
 857   2              main_board_contrl_send(0x05,0,0); //è¢«åŠ¨åˆ¹è½¦
 858   2              delayms(30);
 859   2              main_board_contrl_send(0x00,0,0); //ç©ºæŒ¡æ— é˜»åŠ›
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 15  

 860   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 861   2           }
 862   1           delayms(10);
 863   1           send_data(0x81,0x88,1); //å‘é€æŸ¥è¯¢å®šä½çŠ¶æ€æŒ‡ä»¤
 864   1           delayms(30);
 865   1           Lcd_set_val("jiaodu.val=",(int)(*(real_data)*0.01));//å‘LCDæ¨¡ç»„å‘é€å®šä½å€¼
 866   1           delayms(10);
 867   1           
 868   1           
 869   1           send_data(0x81,0x97,2); //æŸ¥è¯¢IRæ¥æ”¶çŠ¶æ€
 870   1           delayms(30);
 871   1           if((*(real_data)>>8)!=0xf1)
 872   1           {
 873   2             Lcd_set_val("ir4.val=",*(real_data)>>8);
 874   2             delayms(10);
 875   2             Lcd_set_val("ir3.val=",*(real_data)& 0x00ff);
 876   2             delayms(10);
 877   2             Lcd_set_val("ir2.val=",*(real_data+1)>>8);
 878   2             delayms(10);
 879   2             Lcd_set_val("ir1.val=",*(real_data+1)& 0x00ff);
 880   2             delayms(10);
 881   2           }
 882   1           //delayms(100);
 883   1           
 884   1           //lcd_status=0;//çŠ¶æ€æ¸…é›¶
 885   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 886   1      }
 887          //*
 888          int robot_ctrl_window1(unsigned short *real_data)//æ•´æœºæ§åˆ¶éƒ¨åˆ†
 889          {        
 890   1             uchar run_speed = 20;
 891   1             uchar tun_speed =10;  
 892   1            *real_data = 0xf1f0;
 893   1      
 894   1             switch(lcd_status)
 895   1             {
 896   2                case auto_charge_on : main_board_contrl_send1(0x80,0,0);  break;
 897   2                case auto_charge_off : main_board_contrl_send1(0x00,0,0);  break;
 898   2                case go_up : main_board_contrl_send1(0x01,run_speed,run_speed);  break;
 899   2                case go_down : main_board_contrl_send1(0x02,run_speed,run_speed); break;
 900   2                case go_left : main_board_contrl_send1(0x04,0,tun_speed); break;
 901   2                case go_right : main_board_contrl_send1(0x03,tun_speed,0); break;
 902   2                case go_stop : main_board_contrl_send1(0x05,0,0); //è¢«åŠ¨åˆ¹è½¦
 903   2                               delayms(30);
 904   2                               main_board_contrl_send1(0x00,0,0); //ç©ºæŒ¡æ— é˜»åŠ›
 905   2                               break;
 906   2                 default :break;
 907   2              }
 908   1          
 909   1           if(lcd_status==Return_button1)//æŒ‰ä¸‹é€€å‡ºæŒ‰é”®
 910   1           {
 911   2              //printf("return_button\n");
 912   2              Lcd_control( "page main1");
 913   2              lcd_status = main_window;
 914   2              main_board_contrl_send1(0x05,0,0); //è¢«åŠ¨åˆ¹è½¦
 915   2              delayms(30);
 916   2              main_board_contrl_send1(0x00,0,0); //ç©ºæŒ¡æ— é˜»åŠ›
 917   2              return -1;//å¦‚æœå—åˆ°è¿”å›ä¿¡å·
 918   2           }
 919   1           delayms(10);
 920   1           send_data(0x81,0x88,1); //å‘é€æŸ¥è¯¢å®šä½çŠ¶æ€æŒ‡ä»¤
 921   1           delayms(30);
C51 COMPILER V9.00   LCD_WINDOW                                                            05/13/2019 20:38:13 PAGE 16  

 922   1           Lcd_set_val("jiaodu.val=",(int)(*(real_data)*0.01));//å‘LCDæ¨¡ç»„å‘é€å®šä½å€¼
 923   1           delayms(10);
 924   1           
 925   1           
 926   1           send_data(0x81,0x99,2); //æŸ¥è¯¢IRæ¥æ”¶çŠ¶æ€
 927   1           delayms(30);
 928   1           if((*(real_data)>>8)!=0xf1)
 929   1           {
 930   2             Lcd_set_val("ir4.val=",*(real_data)>>8);
 931   2             delayms(10);
 932   2             Lcd_set_val("ir3.val=",*(real_data)& 0x00ff);
 933   2             delayms(10);
 934   2             Lcd_set_val("ir2.val=",*(real_data+1)>>8);
 935   2             delayms(10);
 936   2             Lcd_set_val("ir1.val=",*(real_data+1)& 0x00ff);
 937   2             delayms(10);
 938   2           }
 939   1           //delayms(100);
 940   1           
 941   1           //lcd_status=0;//çŠ¶æ€æ¸…é›¶
 942   1         return 0;//æ­£å¸¸åˆ·æ–°æ•°æ®
 943   1      }//*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   7738    ----
   CONSTANT SIZE    =    810    ----
   XDATA SIZE       =   ----      93
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
